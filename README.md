# ü§ñ Text-to-SQL –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –ë–æ—Ç

## üìñ –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–æ–¥—É–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö PostgreSQL –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ —á–µ—Ä–µ–∑ Telegram-–±–æ—Ç.

1.  **Telegram Bot:** –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ **Aiogram 3**.
2.  **FastAPI Backend:** –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –æ—Ç –±–æ—Ç–∞.
3.  **LLM Service:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **Gemini 2.5 Flash** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ SQL-–∑–∞–ø—Ä–æ—Å–∞.
4.  **PostgreSQL:** –•—Ä–∞–Ω–∏—Ç –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ –¥–∞–Ω–Ω—ã–º.



## üõ†Ô∏è –°—Ç–µ–∫ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–π

* **Backend:** Python 3.11+ (FastAPI)
* **LLM:** Gemini 2.5 Flash
* **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL (asyncpg)
* **–ë–æ—Ç:** Aiogram 3.x
* **–î–µ–ø–ª–æ–π:** Docker Compose

## üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –ó–∞–ø—É—Å–∫

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –û–∫—Ä—É–∂–µ–Ω–∏—è (`.env`)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –∫–ª—é—á–∞–º–∏:

* `GEMINI_API_KEY`: –í–∞—à –∫–ª—é—á –¥–ª—è Google Gemini.
* `TELEGRAM_BOT_TOKEN`: –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞.
* `DATABASE_URL`: –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL (–Ω–∞–ø—Ä–∏–º–µ—Ä, `postgresql://user:password@db:5432/analytics_db`).

### 2. –ó–∞–ø—É—Å–∫

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª—ã `schema.sql` (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î) –∏ `videos.json` (–¥–∞–Ω–Ω—ã–µ) –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞.

–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (PostgreSQL, FastAPI, Bot) —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

```bash
docker compose up --build
```

### 3. –ó–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É—é (–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

–£—Å—Ç–∞–Ω–æ–≤–∫–∞: pip install -r requirements.txt

–ó–∞–ø—É—Å–∫ –ë–î: –ó–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL.

–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö: python data_loader.py

–ó–∞–ø—É—Å–∫ API: uvicorn main:app --reload --host 0.0.0.0 --port 8000

–ó–∞–ø—É—Å–∫ –ë–æ—Ç–∞: python bot.py

üí¨ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–ù–∞—á–Ω–∏—Ç–µ –¥–∏–∞–ª–æ–≥ —Å –±–æ—Ç–æ–º –≤ Telegram –∏ –∑–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–µ—Ä–º–∏–Ω—ã –∏–∑ –≤–∞—à–µ–π —Å—Ö–µ–º—ã –ë–î:

–ü—Ä–∏–º–µ—Ä: "–°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –≤–∏–¥–µ–æ?"

–ü—Ä–∏–º–µ—Ä: "–ö–∞–∫–æ–π —Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é?"

üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü—Ä–æ–µ–∫—Ç–∞
main.py: FastAPI Backend (API-–º–∞—Ä—à—Ä—É—Ç—ã, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É–ª–æ–º –ë–î)

llm_service.py: –õ–æ–≥–∏–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ SQL —á–µ—Ä–µ–∑ Gemini

bot.py: –õ–æ–≥–∏–∫–∞ Telegram-–±–æ—Ç–∞

data_loader.py: –°–∫—Ä–∏–ø—Ç –¥–ª—è ETL (–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î)

logging_config.py: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è

docker-compose.yml: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞

requirements.txt: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
